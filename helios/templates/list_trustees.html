{% extends "helios/templates/cryptobase.html" %}
{% load i18n %}
{% block title %}{% trans "Trustees for" %} {{election.name}}{% endblock %}

{% block content %}
  <h3 class="title">{{election.name}} &mdash; {% trans "Trustees" %} <span style="font-size:0.7em;">[<a href="{% url "helios.views.one_election_view" election.uuid %}">{% trans "back to election" %}</a>]</span></h3>

<p>
    {% trans "Trustees are responsible for decrypting the election result." %}<br />
    {% trans "Each trustee generates a keypair and submits the public portion to Helios." %}<br />
    {% trans "When it's time to decrypt, each trustee needs to provide their secret key." %}
</p>

{% if not election.frozen_at %}

<p>
  {% trans "Helios is automatically your first trustee and will handle its keypair generation and decryption automatically." %}<br />
  {% trans "You may add additional trustees if you want, and you can even remove the Helios trustee." %}<br />
  {% trans "However, we recommend you do this only if you have a solid understanding of the trustee's role." %}
</p>

{% if admin_p %}
<p>
    [ <a onclick="return(confirm('{% trans "Adding your own trustee requires a good bit more work to tally the election." %}\n{% trans "You will need to have trustees generate keypairs and safeguard their secret key." %}\n\n{% trans "If you are not sure what that means, we strongly recommend" %}\n{% trans "clicking Cancel and letting Helios tally the election for you." %}'));" href="{% url "helios.views.new_trustee" election.uuid %}">{% trans "add a trustee" %}</a> ]
</p>
{% if not election.has_helios_trustee %}
<p>
    <a href="{% url "helios.views.new_trustee_helios" election.uuid %}">{% trans "add Helios as a trustee" %}</a>
</p>
{% endif %}
{% endif %}

{% endif %}

{% if not trustees|length %}

{% else %}
{% for t in trustees %}
<h5> {% trans "Trustee" %} #{{forloop.counter}}: {{t.name}} 
{% if admin_p %}
{% if t.secret_key %}
{% if not election.frozen_at %}[<a onclick="return confirm('{% trans "Are you sure you want to remove Helios as a trustee?" %}');" href="{% url "helios.views.delete_trustee" election.uuid %}?uuid={{t.uuid}}">x</a>]{% endif %}
{% else %}
({{t.email}})
{% if not election.frozen_at %}[<a onclick="return confirm('{% trans "Are you sure you want to remove this Trustee?" %}');" href="{% url "helios.views.delete_trustee" election.uuid %}?uuid={{t.uuid}}">x</a>]{% endif %}
[<a onclick="return confirm('{% trans "Are you sure you want to send this trustee his/her admin URL?" %}');" href="{% url "helios.views.trustee_send_url" election.uuid t.uuid %}">{% trans "send login" %}</a>]
{% endif %}
{% endif %}
</h5>

<p>
{% if t.public_key_hash %}
  {% trans "Public Key Fingerprint:" %} <tt style="font-size:1.5em;">{{t.public_key_hash}}</tt>
{% else %}
{% trans "No public key uploaded yet." %}
{% endif %}
</p>

{% if election.encrypted_tally %}
{% if t.decryption_factors %}
<b>{% trans "tally recorded for this trustee." %}</b>
{% else %}
<em>{% trans "waiting for this trustee's tally" %}</em>
{% endif %}
{% endif %}
</li>
{% endfor %}
</ul>

{% endif %}

{% endblock %}
